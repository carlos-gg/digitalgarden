{"version":3,"file":"GlParticleContainerAdaptor.mjs","sources":["../../../../src/scene/particle-container/gl/GlParticleContainerAdaptor.ts"],"sourcesContent":["import type { WebGLRenderer } from '../../../rendering/renderers/gl/WebGLRenderer';\nimport type { ParticleContainer } from '../shared/ParticleContainer';\nimport type { ParticleContainerAdaptor, ParticleContainerPipe } from '../shared/ParticleContainerPipe';\n\nexport class GlParticleContainerAdaptor implements ParticleContainerAdaptor\n{\n    public execute(particleContainerPop: ParticleContainerPipe, container: ParticleContainer)\n    {\n        const state = particleContainerPop.state;\n        const renderer = particleContainerPop.renderer as WebGLRenderer;\n        const shader = container.shader || particleContainerPop.defaultShader;\n\n        shader.resources.uTexture = container.texture._source;\n        shader.resources.uniforms = particleContainerPop.localUniforms;\n\n        const gl = renderer.gl;\n\n        const buffer = particleContainerPop.getBuffers(container);\n\n        // now lets upload and render the buffers..\n        renderer.shader.bind(shader);\n        renderer.state.set(state);\n        renderer.geometry.bind(buffer.geometry, shader.glProgram);\n\n        const byteSize = buffer.geometry.indexBuffer.data.BYTES_PER_ELEMENT;\n        const glType = byteSize === 2 ? gl.UNSIGNED_SHORT : gl.UNSIGNED_INT;\n\n        gl.drawElements(gl.TRIANGLES, container.particleChildren.length * 6, glType, 0);\n    }\n}\n"],"names":[],"mappings":";AAIO,MAAM,0BACb,CAAA;AAAA,EACW,OAAA,CAAQ,sBAA6C,SAC5D,EAAA;AACI,IAAA,MAAM,QAAQ,oBAAqB,CAAA,KAAA,CAAA;AACnC,IAAA,MAAM,WAAW,oBAAqB,CAAA,QAAA,CAAA;AACtC,IAAM,MAAA,MAAA,GAAS,SAAU,CAAA,MAAA,IAAU,oBAAqB,CAAA,aAAA,CAAA;AAExD,IAAO,MAAA,CAAA,SAAA,CAAU,QAAW,GAAA,SAAA,CAAU,OAAQ,CAAA,OAAA,CAAA;AAC9C,IAAO,MAAA,CAAA,SAAA,CAAU,WAAW,oBAAqB,CAAA,aAAA,CAAA;AAEjD,IAAA,MAAM,KAAK,QAAS,CAAA,EAAA,CAAA;AAEpB,IAAM,MAAA,MAAA,GAAS,oBAAqB,CAAA,UAAA,CAAW,SAAS,CAAA,CAAA;AAGxD,IAAS,QAAA,CAAA,MAAA,CAAO,KAAK,MAAM,CAAA,CAAA;AAC3B,IAAS,QAAA,CAAA,KAAA,CAAM,IAAI,KAAK,CAAA,CAAA;AACxB,IAAA,QAAA,CAAS,QAAS,CAAA,IAAA,CAAK,MAAO,CAAA,QAAA,EAAU,OAAO,SAAS,CAAA,CAAA;AAExD,IAAA,MAAM,QAAW,GAAA,MAAA,CAAO,QAAS,CAAA,WAAA,CAAY,IAAK,CAAA,iBAAA,CAAA;AAClD,IAAA,MAAM,MAAS,GAAA,QAAA,KAAa,CAAI,GAAA,EAAA,CAAG,iBAAiB,EAAG,CAAA,YAAA,CAAA;AAEvD,IAAG,EAAA,CAAA,YAAA,CAAa,GAAG,SAAW,EAAA,SAAA,CAAU,iBAAiB,MAAS,GAAA,CAAA,EAAG,QAAQ,CAAC,CAAA,CAAA;AAAA,GAClF;AACJ;;;;"}