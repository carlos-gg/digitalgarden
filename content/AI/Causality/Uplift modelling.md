---
title: Uplift modelling
---

> Uplift modeling refers to the set of techniques used to model the incremental impact of an action or treatment on a customer outcome. Uplift modeling is therefore both a Causal Inference problem and a Machine Learning one. 
> The fundamental problem of causal inference -- uplift modeling aims to estimate a customers "probability of persuasion" by the treatment. The main difficulty is that this is not directly measurable: we can observe the outcome after treating or not treating, but can not know what the outcome would have been for the opposite treatment choice (to compute the difference an obtain an uplift). Hence, uplift models have to be trained on data from an A/B test of treated and untreated customers and their respective outcome, and learn from that

## Resources
- [GitHub - JackHCC/Awesome-Uplift-Model](https://github.com/JackHCC/Awesome-Uplift-Model)
- [Causal Inference and Uplift Modelling: A Review of the Literature (mlr.press)](http://proceedings.mlr.press/v67/gutierrez17a.html)
- [How uplift modeling works | Blogs (ambiata.com)](https://ambiata.com/blog/2020-07-07-uplift-modeling/)
- [Supercharging customer touchpoints with uplift modeling | by Steve Klosterman | TDS](https://towardsdatascience.com/supercharging-customer-touchpoints-with-uplift-modeling-9913ddf62c1)
    - [https://www.steveklosterman.com/uplift-modeling/](https://www.steveklosterman.com/uplift-modeling/) 
- [Uplift vs other models — scikit-uplift 0.5.1 documentation (uplift-modeling.com)](https://www.uplift-modeling.com/en/latest/user_guide/introduction/comparison.html)
- [Understanding Customer Behaviour Using Uplift Modelling - The Data Lab](https://thedatalab.com/tech-blog/understanding-customer-behaviour-using-uplift-modelling/)
- [Understanding the Limitations and Opportunities of Uplift Modelling with CausalML](https://aitechtrend.com/understanding-the-limitations-and-opportunities-of-uplift-modelling-with-causalml/#:~:text=The%20two-model%20approach%20involves%20building%20two%20separate%20models%3A,two%20predictions%20represents%20the%20uplift%20or%20incremental%20benefit)
- [A quick guide to machine learning uplift models (practicaldatascience.co.uk)](https://practicaldatascience.co.uk/machine-learning/a-quick-guide-to-machine-learning-uplift-models)
- [Introduction to uplift — pylift 0.1.3 documentation](https://pylift.readthedocs.io/en/latest/introduction.html)
- [Methodology — causalml documentation](https://causalml.readthedocs.io/en/latest/methodology.html)
- [Types of customers — scikit-uplift 0.5.1 documentation (uplift-modeling.com)](https://www.uplift-modeling.com/en/latest/user_guide/introduction/clients.html)
- [From predictive uplift modeling to prescriptive uplift analytics: A practical approach to treatment optimization while accounting for estimation risk | SpringerLink](https://link.springer.com/article/10.1057/jma.2015.5)
- [Logistic or linear? Estimating causal effects of experimental treatments on binary outcomes using regression analysis](https://psyarxiv.com/4gmbv)
- [Beyond Churn Prediction and Churn Uplift | by Matteo Courthoud | Jul, 2023 | Towards Data Science](https://towardsdatascience.com/beyond-churn-prediction-and-churn-uplift-45225e5a7541)
- [Evaluating Uplift Models. How to compare and pick the best uplift… | by Matteo Courthoud | Jul, 2023 | Towards Data Science](https://towardsdatascience.com/evaluating-uplift-models-8a078996a113)
- [Creación, entrenamiento y evaluación de un modelo de elevación - Microsoft Fabric | Microsoft Learn](https://learn.microsoft.com/es-es/fabric/data-science/uplift-modeling)
- [Blog post | Preventing churn like a bandit](https://bigdatarepublic.nl/articles/preventing-churn-bandit/)
	- [https://medium.com/bigdatarepublic/preventing-churn-like-a-bandit-49b7c51b4929](https://medium.com/bigdatarepublic/preventing-churn-like-a-bandit-49b7c51b4929)
	- [https://pydata.org/eindhoven2019/schedule/presentation/16/preventing-churn-like-a-bandit/](https://pydata.org/eindhoven2019/schedule/presentation/16/preventing-churn-like-a-bandit/)
	- [Gerben Oostra: Preventing churn like a bandit | PyData Eindhoven 2019](https://www.youtube.com/watch?v=n1uqeBNUlRM)
	- El objetivo real es prevenir el churn, no predecirlo. Por lo tanto, en lugar de predecir el churn en sí, se busca predecir el efecto de los tratamientos. Una técnica útil para esto es la transformación de resultados, que modifica las etiquetas en el conjunto de datos para que el modelo prediga el aumento/uplift.
	- [https://towardsdatascience.com/beyond-churn-an-introduction-to-uplift-modeling-d1d9af7be](https://towardsdatascience.com/beyond-churn-an-introduction-to-uplift-modeling-d1d9af7be)
	- Se utiliza la modelización bayesiana y el muestreo de Thompson para equilibrar la exploración y la explotación, obteniendo así retroalimentación de calidad para volver a entrenar el modelo.
- [Simple Machine Learning Techniques To Improve Your Marketing Strategy: Demystifying Uplift Models | by Josh Xin Jie Lee | DataDrivenInvestor (medium.com)](https://medium.com/datadriveninvestor/simple-machine-learning-techniques-to-improve-your-marketing-strategy-demystifying-uplift-models-dc4fb3f927a2)
    - [Data_Scientist_Nanodegree/starbucks_portfolio_exercise/Starbucks.ipynb at master · joshxinjie/Data_Scientist_Nanodegree · GitHub](https://github.com/joshxinjie/Data_Scientist_Nanodegree/blob/master/starbucks_portfolio_exercise/Starbucks.ipynb)
    - how do you identify individuals who are only likely to purchase your product after receiving your promotional coupon, but would not have done so otherwise? with uplift modelling
    - “uplift modelling, also known as incremental modelling, true lift modelling, or net modelling is a predictive modelling technique that directly models the incremental impact of a treatment (such as a direct marketing action) on an individual’s behavior”
    - Utilizing these models can help your firm maximize profits by keeping advertising cost to the minimum
    - Binary case, multitreatment not discussed
- [Why start using uplift models for more efficient marketing campaigns](https://www.youtube.com/watch?v=2J9j7peWQgI&ab_channel=DataConLA)
	- Talk from Uber - CausalML
	- Foco en modelos de propensity y en A/B testing (ATE - Average Treatment Effect)
	- Uplift modelling optimiza el efecto de incremento/aumento y permite tratamiento personalizado de clientes (CATE - Conditional Average Treatment Effect)
	- Uplift se encarga de estimar los efectos de tratamientos heterogeneos usando ML
	- CATE = E[Y|Tratamiento,X] - E[Y|No Tratamiento,X]
	- Sure things and lost causes, harán lo que quieran sin importar el tratamiento (perdida de recursos si se aplica tratamiento). Sleeping dogs son aquellos que reaccionan negativamente al tratamiento, no deben ser incluidos. Persudable son aquellos que importan, ya que reaccionan positivamente al tratamiento (peso superior en el modelo)
	- Evaluación:
	    - Experimentación - para ATE se corren experimentos controlados (A/B tests)
	    - Consistencia
	    - Datos sintéticos - con true labels (efecto de tratamiento) para medir la precisión de CATE. El problema es que depende mucho de el proceso de generación que no se va a ajustar del todo a datos reales
- [PyConDE & PyData Berlin 2022: Introduction to Uplift Modeling - Dr. Juan Camilo Orduz (juanitorduz.github.io)](https://juanitorduz.github.io/uplift/)
	- [Introduction to Uplift Modeling](https://www.youtube.com/watch?v=VWjsi-5yc3w&ab_channel=PyData)
	    - En uplift modelling queremos medir el efecto causal del resultado/outcome para un usuario que ha recibido un tratamiento menos el resultado cuando no lo ha recibido t_i = Y_i^1 - Y_i^0
	    - Para esto utilizamos el feature vector del usuario, y estimamos el efecto condicional medio del tratamiento (conditional average treatment effect)  
	- El problema es que este efecto causal no lo podemos observar
	- Estamos interesados en la expectación de este efecto de tratamiento condicionado en las caracteristicas del usuario
	- W_i es la variable binaria que denota si el usuario recibió el tratamiento
	- unconfoundedness assumption (suposición de inconfundibilidad) consiste en que la asignación de tratamiento W_i es independiente de el outcome Y_1 y Y_0 condicionado por X_i
	- Si este se cumple podemos calcular CATE de datos observacionales 
	- Como obtenemos datos? Un A/B test típico, usuarios se reparten en grupos control y tratamiento (unos reciben el tratamiento y otros no), y se recoge el outcome (revenue, conversion)
	- Metodos:
	    - Meta-learners: X-learner, T-learner, X-learner. Agnostico con respecto al método 
	- Metricas de evaluacion: uplift by percentile, cumulative gain chart, uplift curves

### Metrics
- Metrics for evaluating uplift are more complex than typical metrics used in supervised learning, such as the ROC AUC. This is because it is not possible to observe both the control and the treatment outcomes for a given individual at the same time, which makes it dicult to find a loss measure.
- [kdd2011late.pdf (stochasticsolutions.com)](https://www.stochasticsolutions.com/pdf/kdd2011late.pdf) Quality measures for uplift models
- [About evaluation metrics for contextual uplift modeling (arxiv.org)](https://arxiv.org/abs/2107.00537)
- [Usage: evaluation — pylift 0.1.3 documentation](https://pylift.readthedocs.io/en/latest/evaluation.html)
- Qini curves for multi-armed treatment rules
	- [Qini curves: Automatic cost-benefit analysis • grf (grf-labs.github.io)](https://grf-labs.github.io/grf/articles/maq.html)
	- [Add multi-armed Qini (maq) · Issue #662 · uber/causalml (github.com)](https://github.com/uber/causalml/issues/662)
- Qini Curve
	- [How uplift modeling works | Blogs (ambiata.com)](https://ambiata.com/blog/2020-07-07-uplift-modeling/)
	- [2002.05897.pdf (arxiv.org)](https://arxiv.org/pdf/2002.05897.pdf) discussed here
	- Plots the cumulative uplift across the population
	- We rank the customers by their predicted uplift on the horizontal axis, and the vertical axis plots the cumulative number of purchases in the treatment group (scaled by the total treatment size) minus the cumulative number of purchases in control (scaled by the total control size)
	- The straight line corresponds to randomly targeting customers for treatmentw
	- The Qini curve represents the cumulative incremental gains as a function of the selected fraction of the ranked population, while the black line represents the expected value of a random sub-sample of that size, called the random baseline
	- We expect a good uplift model to rank first the individuals likely to respond when treated, leading to higher estimated uplift values in the early parts of the plot
	- A highly right-skewed uplift curve is desirable, since it indicates that the likely responders are primarily grouped in the top segments
	- The oracle curve looks like this because of the synthetic dataset used - all 4 classes of customers are balanced, as well as the outcome/reward and the treatment/control distribution, ending in a net 0 uplift.
	    - This curve increases sharply as the proportion of the population targeted for treatment increases from 0%. This is because the targeted customers are all persuadables, and they all contribute positive uplift. Once this population of persuadables is exhausted (at about 25%), the next customers to be targeted for treatment are all sure things and lost causes. These customers do not contribute any uplift, so the curve stays flat as this middle 50% (from 25% to 75%) gets targeted. Once this segment of the population is exhausted, the only customers left are the sleeping dogs, which contribute negative uplift.
	    - This dataset effectively simulates an A/B test, and we can calculate the uplift by subtracting the control conversion rate (0.496) from the target conversion rate (0.494), to give an overall uplift of -0.002
	    - However, if we calculate the treatment/control conversion rates and uplifts for each customer type separately, we see how they behave differently
	- La curva de Qini proporciona una medida visual del impacto del tratamiento en la respuesta de los sujetos, donde en el eje x tienes el porcentaje de clientes seleccionados y en el eje y tienes la diferencia en la tasa de respuesta acumulativa entre el grupo de tratamiento y el grupo de control
    - Como se construye:
        - Ordenar los clientes por probabilidad de uplift, de mayor a menor
        - Calcular las tasas de respuesta acumulativa para cada porcentaje de clientes seleccionados, tanto en el grupo de tratamiento como en el grupo de control
        - Normalizar la respuesta acumulativa con respecto al número de clientes en tratamiento y control hasta ese punto
        - Obtener la diferencia entre las tasa de respuesta acumulativa del grupo de tratamiento y del grupo de control en función del porcentaje de clientes seleccionados
        - Esta curva muestra el impacto del tratamiento en la respuesta de los clientes 
    - Como se interpreta:
        - Pendiente de la curva indica que tan efectivo es el tratamiento, entre más pronunciada india un mayor impacto en la respuesta de los clientes
        - Área bajo la curva (AUC), o índice de Qini, da una medida cuantitativa de la efectividad del tratamiento
        - Punto corte óptimo se puede identificar en la curva de Qini, o sea el punto en el cual seleccionar a los clientes para que el tratamiento tenga mayor impacto (punto de inflexión)
        - Comparación la línea base, que representa la ganancia de tratar a los sujetos aleatoriamente.
            - Es una línea recta que se traza desde el origen (0, 0) hasta el punto final (1, T), donde T es la proporción de clientes que pertenecen al grupo de tratamiento en el conjunto de datos
            - La línea base representa el resultado esperado si se seleccionara aleatoriamente a la población objetivo sin tener en cuenta el modelo de uplift  
    - Curva perfecta:
        - Esta curva se obtiene al clasificar a los individuos en orden descendente según su efecto de tratamiento estimado y luego calcular la ganancia acumulada incremental para cada grupo de individuos. Cuanto más cerca esté la curva Qini real de la curva perfecta, mejor será el rendimiento del modelo
        - escenario ideal, donde se utiliza la diferencia entre las respuestas verdaderas bajo tratamiento y sin tratamiento para cada cliente (y_true * treatment - y_true * (1 - treatment)). Un valor positivo indica una mejora en la respuesta debido al tratamiento, mientras que un valor negativo indica una reducción en la respuesta debido al tratamiento
        
### Meta-learners
- [Meta-Learners (Causal Inference for The Brave and True)](https://matheusfacure.github.io/python-causality-handbook/21-Meta-Learners.html)
- [Meta-Learners — econml 0.14.1 documentation](https://econml.azurewebsites.net/spec/estimation/metalearners.html)
- [Multiple Treatments Uplift Models for Binary Outcome Using Python CausalML](https://medium.com/grabngoinfo/multiple-treatments-uplift-models-for-binary-outcome-using-python-causalml-b2203f589a67)
- X-learner:
	- [X-Learner Uplift Model in Python. Manually create meta-learner X-learner… | by Amy @GrabNGoInfo | GrabNGoInfo | Medium](https://medium.com/grabngoinfo/x-learner-uplift-model-in-python-768260a06a4a)
	- Extension of the T-learner
	- Stage 1: ML models to predict the outcomes, one for control and one for each treatment
	    - Imputed ITE is calculated using both models, eg if the sample is from the treatment group, the ITE is the actual outcome minus the counterfactual outcome predicted by the control model
	- Stage 2: ML models are trained to predict the imputed ITE, treatment and control separately
	    - Then imputed ITE predictions are calculated with these models for all the samples
	- Stage 3: a propensity model is trained to predict the propensity of getting treatment, used as a weight for the ITE calculation
	- Finally, the ITE is estimated as the propensity weighted average of the stage 2 predictions
	- Propensity score weighting can help the X-Learner deal with treatment selection bias
### Transformed outcome
- [Machine Learning for Estimating Heterogeneous Casual Effects](https://www.gsb.stanford.edu/faculty-research/working-papers/machine-learning-estimating-heretogeneous-casual-effects) 
    - [Link with PDF on Github](https://github.com/manjunath5496/ML-Papers/blob/main/Machine%20Learning%20Methods%20for%20Estimating%20Heterogeneous%20Causal%20Effects.pdf)
- [TransOut — pylift 0.1.3 documentation](https://pylift.readthedocs.io/en/latest/introduction.html#the-transformed-outcome)
- [sklift.models.ClassTransformationReg — scikit-uplift 0.5.1 documentation (uplift-modeling.com)](https://www.uplift-modeling.com/en/latest/api/models/ClassTransformationReg.html#sklift.models.models.ClassTransformationReg)
- [Transformed Outcome — scikit-uplift 0.5.1 documentation (uplift-modeling.com)](https://www.uplift-modeling.com/en/latest/user_guide/models/transformed_outcome.html)
	- CATE-generating (Conditional Average Treatment Effect) Transformation of the Outcome
	- Como asignar P:
	    - P=0.5 significaría que cada sujeto tiene igual probabilidad de ser asignado al grupo de tratamiento, pero solo puede ser usado en casos que tengamos el mismo número de sujetos en el grupo control y de tratamiento
	    - En el caso binario, se podría estimar como la proporción de sujetos con W=1
	    - Se puede utilizar un clasificador para predecir W (que un sujeto sería asignado al grupo de tratamiento) como función de X y evaluar P
### Domain Adaptation Learner
- Meta-algorithm that uses domain adaptation techniques to account forcovariate shift (selection bias) among the treatment arms.
- [econml.metalearners.DomainAdaptationLearner — econml 0.14.1 documentation](https://econml.azurewebsites.net/_autosummary/econml.metalearners.DomainAdaptationLearner.html)
- [Meta-Learners — econml 0.14.1 documentation](https://econml.azurewebsites.net/spec/estimation/metalearners.html#domain-adaptation-learner)
### Bayesian methods
- [Causal inference with  Bayesian models | A. Solomon Kurz](https://solomonkurz.netlify.app/blog/2023-04-30-causal-inference-with-bayesian-models/)
- [ATE Estimation with Logistic Regression - Dr. Juan Camilo Orduz](https://juanitorduz.github.io/causal_inference_logistic/)
### Continuous outcome
- [Multiple Treatments Uplift Model for Continuous Outcome Using Python Package CausalML | by Amy @GrabNGoInfo | GrabNGoInfo | Medium](https://medium.com/grabngoinfo/multiple-treatments-uplift-model-using-python-package-causalml-95c4aa5b7fcf)
- [Uplift Forest for Multiple Treatments and Continuous Outcomes | Semantic Scholar](https://www.semanticscholar.org/paper/Uplift-Forest-for-Multiple-Treatments-and-Outcomes-Gubela-Lessmann/5ff22e175cd957bdd9b78f848e877f856d865c2d)
- Libraries: pylift, sklift ClassTransformationOutcomeReg, meta learners in causalml
### IPW
- IPW or Inverse probability weighting is a statistical technique for calculating statistics standardized to a pseudo-population different from that in which the data was collected
- [An introduction to inverse probability of treatment weighting in observational research](https://academic.oup.com/ckj/article/15/1/14/6358134?login=false)
- [Causal Inference 102 EP04: Implementation of Inverse Probability Weighting | by Xwang | Medium](https://medium.com/@xwang222/causal-inference-102-ep04-implementation-of-inverse-probability-weighting-446a67caf336)
- [Inverse Probability Treatment Weighting (IPTW) Using Python Package Causal Inference | by Amy @GrabNGoInfo | GrabNGoInfo | Medium](https://medium.com/grabngoinfo/inverse-probability-treatment-weighting-iptw-using-python-package-causal-inference-7d8f454eb8f3)
- #PAPER [Propensity Score Weighting for Causal Inference with Multiple Treatments (arxiv.org)](https://arxiv.org/abs/1808.05339)
- Los datos históricos pueden tener sesgos, por lo que es necesario distinguir entre correlación y causalidad. La técnica de inferencia causal denominada "inverse propensity weighting" logra esto.
    - Inverse Propensity Weighting (IPW), también conocido como ponderación de propensidad inversa, es una técnica utilizada en el ámbito de la inferencia causal para abordar el sesgo de selección en la estimación de efectos causales. Se utiliza cuando los datos observados presentan un desequilibrio en la asignación de tratamientos, lo que puede llevar a estimaciones incorrectas de los efectos causales.
    - La idea detrás del IPW es asignar pesos a las muestras en función de la probabilidad inversa de recibir el tratamiento observado.
    - Se construye un modelo predictivo que estime la probabilidad de recibir el tratamiento en función de las características de los usuarios (modelo de propensidad)
    - Los pesos de propensidad inversa se obtienen dividiendo 1 por la probabilidad estimada de recibir el tratamiento para cada grupo
    - El IPW asume que el modelo de propensidad es correcto y captura todas las variables relevantes que influyen en la asignación de tratamientos
    - Además, en algunos casos, los pesos de propensidad inversa pueden ser muy variables o extremadamente grandes, lo que puede afectar la precisión de las estimaciones. Por lo tanto, es fundamental realizar una evaluación cuidadosa y validación del modelo de propensidad antes de aplicar el IPW en el análisis causal 
- Es uno de los métodos que intenta establecer una comparativa entre los grupos de control y de tratamiento (que no tienen samples balanceados). Hace esto creado una pseudo población con los grupos mas balanceados respect( a las caracteristicas de los samples en ambos grupos)
- IPW primero calcula la probabilidad de ser tratado para cada observacion (propensity score). El balance se mejora utilizando la inversa de este propensity score como un peso
- Ejemplo:
    - tenemos dos pacientes p_1 y p_2 en el grupo de los tratados, con propensity de 0.9 y 0.4. p_1 es diferente del grupo control xq sus caracteristicas le dan una alta prob de ser tratado, si tuvieramos mas p_1 en el grupo tratamiento sería peor
    - Para p_2 podemos decir que sus caracteristicas no determinan la prob de ser tratado, lo que lo hace mas parecido al grupo control, si tuvieramos mas p_2 en el grupo tratamiento ayudaría a balancearlo con respecto al grupo control
    - Con esto vemos que necesitamos menos p_1 y mas p_2 en nuestro grupo tratamiento, o lo que es lo mismo, un peso menor en p_1 y mayor en p_2
- [Understanding inverse propensity weighting | by Gerben Oostra | bigdatarepublic | Medium](https://medium.com/bigdatarepublic/understanding-inverse-propensity-weighting-a191d94bb2eb)
    - Bias caused by treatments not being randomly assigned
    - This happens when there are variables that influence both the treatment assignment and the treatment outcome
    - The effect of the variable can incorrectly be (partly) assigned to the treatment, resulting in a biased model
    - There are different actions (called treatments) that we can do to retain customers (prevent them from churning)
    - The challenge therefore is, who can we treat in such a way that we retain them?
    - We can model this as a classification problem by defining ‘being retained’ as ‘being retained for 3 months’. Customer features go in, together with a ‘treated or not’ flag, and ‘is retained’ comes out. Unfortunately, this doesn’t give us the expected effect (uplift) of a treatment to a certain customer
    - Trimming or clipping of propensities needed because ‘almost zero’ propensities result in practically infinite weights
### Cost optimization
- [Uplift modeling with value-driven evaluation metrics](https://www.sciencedirect.com/science/article/abs/pii/S0167923621001585)
- [A Cost-Optimization Approach to Uplift Modelling - Folio3AI Blog](https://www.folio3.ai/blog/a-cost-optimization-approach-to-uplift-modelling/)
- Unit Selection Based on Conterfactual Logic
    - [r488.pdf (ucla.edu)](https://ftp.cs.ucla.edu/pub/stat_ser/r488.pdf)
    - [causalml/examples/counterfactual_unit_selection.ipynb at master · uber/causalml (github.com)](https://github.com/uber/causalml/blob/master/examples/counterfactual_unit_selection.ipynb)
    - [causalml.optimize.unit_selection — causalml documentation](https://causalml.readthedocs.io/en/latest/_modules/causalml/optimize/unit_selection.html)
- #PAPER [Uplift Modeling for Multiple Treatments with Cost Optimization](https://arxiv.org/abs/1908.05372)
	- The counterfactual value estimation method predicts the outcome for a unit under different treatment conditions using a standard machine learning model
	- Conversion costs are those that we must endure if an individual who is in the treatment group converts. A typical example would be the cost of a promotional voucher
	- Impression costs are those that we need to pay for each individual in the treatment group irrespective of whether they convert. A typical example would be the cost associated with sending an SMS or email
	- [https://github.com/uber/causalml/blob/master/examples/counterfactual_value_optimization.ipynb](https://github.com/uber/causalml/blob/master/examples/counterfactual_value_optimization.ipynb)
	- [https://causalml.readthedocs.io/en/stable/_modules/causalml/optimize/value_optimization.html#CounterfactualValueEstimator](https://causalml.readthedocs.io/en/stable/_modules/causalml/optimize/value_optimization.html#CounterfactualValueEstimator)
	- First we build a classifier to predict the probability of converting given their treatment exposure and other information we may know about them (Smodel)
	- Next we train a regression model to predict the expected value of the guest’s conversion
	    - The expectected value is a cost related variable we setup (have no impact on conversion) 
	- We finally use the ITE predicted by an uplift model
	- Then we optimize our actions using the CVE. It's a non-parametric optimizer, we don’t learn any weights when we use the CVE. Instead, we take the values we have already learned and optimize them for external costs when predicting the action
- [Uplift Modeling with Cost Optimization | by Sean Smith | Towards Data Science](https://towardsdatascience.com/uplift-modeling-with-cost-optimization-1c67a4e13f2)
    - [https://github.com/sms1097/uplift-optimization/](https://github.com/sms1097/uplift-optimization/)
    - Uplift Modelling is a framework under Causal Inference that focuses on determining the best treatment for individual subjects
    - The advantage to Uplift Modelling over traditional statistical learning techniques is that we estimate the counterfactual effects, the results for a scenario that didn’t happen
    - Allows us to answer the “What would have happened if we did X?” question.
    - This measure of the difference between the treatment and the control group is referred to as the Conditional Average Treatment Effect (CATE)
    - The most popular approach to solve this problem in the context of Uplift Modelling is through the use of Meta Learners
    - Meta Learners attempt to learn the psuedo-effects for each treatment and wrap their learning around that estimate
    - Our value of CATE was only capturing the conversion probabilities
    - Here we shift perspectives to consider a CATE that could be used to consider the total value of the conversion as well as the cost of the treatment used to activate the conversion
### Benchmark data
- Criteo Uplift Prediction Dataset
    - [Criteo Uplift Prediction Dataset - Criteo AI Lab](https://ailab.criteo.com/criteo-uplift-prediction-dataset/)
    - [Uplift Modeling , Marketing Campaign Data | Kaggle](https://www.kaggle.com/datasets/arashnic/uplift-modeling)
    - [Uplift modeling using Advertising Data | Kaggle](https://www.kaggle.com/code/milara/uplift-modeling-using-advertising-data)
    - [[2111.10106] A Large Scale Benchmark for Individual Treatment Effect Prediction and Uplift Modeling (arxiv.org)](https://arxiv.org/abs/2111.10106)
    - [A Large Scale Benchmark for Uplift Modeling (bitlater.github.io)](https://bitlater.github.io/files/large-scale-benchmark_comAH.pdf)
    - [Uplift Modeling with Generalization Guarantees (hal.science)](https://hal.science/hal-03268412/document)
    - [iconip_paper.pdf (bitlater.github.io)](https://bitlater.github.io/files/iconip_paper.pdf)
- [Hillstrom](https://www.uplift-modeling.com/en/latest/api/datasets/fetch_hillstrom.html)
    - [Kevin Hillstrom: MineThatData: The MineThatData E-Mail Analytics And Data Mining Challenge](https://blog.minethatdata.com/2008/03/minethatdata-e-mail-analytics-and-data.html)
    - [Kevin Hillstrom: MineThatData: Best Answer: E-Mail Analytics Challenge](https://blog.minethatdata.com/2008/05/best-answer-e-mail-analytics-challenge.html)
    - [HillstromChallenge - report best solution](http://minethatdata.com/Stochastic_Solutions_E-Mail_Challenge_2008.04.30.pdf)
    - [Swaying the Persuadables: Predict Marketing Uplift in Python | by Heiko Onnen | Towards Data Science](https://towardsdatascience.com/swaying-the-persuadables-predict-marketing-uplift-in-python-c5e9fd855b80) 
- [ADS-16 Computational Advertising Dataset](https://www.kaggle.com/datasets/groffo/ads16-dataset?resource=download).
    - 300 treatments, se podrian quitar varios tratamientos (imágenes, etc), o variables
    - [https://ceur-ws.org/Vol-1680/paper3.pdf](https://ceur-ws.org/Vol-1680/paper3.pdf)
    - [https://arxiv.org/ftp/arxiv/papers/2008/2008.00727.pdf](https://arxiv.org/ftp/arxiv/papers/2008/2008.00727.pdf)
    - Se puede hacer semi sintético, como cuanto dinero se ha generado, o coste de los treatments, para calcular el incremento en cuanto a propension de enviar el sms/treatment
    - 120 usuarios! Muy poco 
- [Open Bandit Dataset](https://github.com/st-tech/zr-obp/tree/master/obd)
    - 80 productos, caracteristicas de prod, afinidad prod y usuario
    - [Open Bandit Dataset and Pipeline: Towards Realistic and Reproducible Off-Policy Evaluation (arxiv.org)](https://arxiv.org/abs/2008.07146)
    - [zr-obp/obd at master · st-tech/zr-obp · GitHub](https://github.com/st-tech/zr-obp/tree/master/obd)
    - [zr-obp/examples/quickstart/obd.ipynb at master · st-tech/zr-obp · GitHub](https://github.com/st-tech/zr-obp/blob/master/examples/quickstart/obd.ipynb) 
- [Criteo 1TB Click Logs dataset](https://ailab.criteo.com/download-criteo-1tb-click-logs-dataset/)
    - Click o no click en base a anuncios
    - [https://arxiv.org/pdf/1612.00367.pdf](https://arxiv.org/pdf/1612.00367.pdf)
    - [https://www.kaggle.com/competitions/criteo-display-ad-challenge/data](https://www.kaggle.com/competitions/criteo-display-ad-challenge/data) 
- [R6A & R6B - Yahoo! Front Page Today Module User Click Log Dataset](https://webscope.sandbox.yahoo.com/catalog.php?datatype=r)
- Scikit-uplift datasets: [https://www.uplift-modeling.com/en/latest/tutorials.html#exploratory-data-analysis](https://www.uplift-modeling.com/en/latest/tutorials.html#exploratory-data-analysis)
- [GitHub - fidelity/mab2rec: Mab2Rec: Multi-Armed Bandits Recommender](https://github.com/fidelity/mab2rec/tree/main)
    - [mab2rec/notebooks/1_data_overview.ipynb at main · fidelity/mab2rec · GitHub](https://github.com/fidelity/mab2rec/blob/main/notebooks/1_data_overview.ipynb)
    - Mas para recomendación 
- Datos Sinteticos:
	- [Uplift Modeling Synthetic Benchmark (openai.com)](https://chat.openai.com/share/95fc94ff-c33e-46b2-9cfa-74c4fc044952)
	- Causalml - [Examples — causalml documentation](https://causalml.readthedocs.io/en/latest/examples.html#synthetic-data-generation-process)
	- [https://github.com/st-tech/zr-obp/tree/master/examples](https://github.com/st-tech/zr-obp/tree/master/examples)

## Code
- #CODE [salesforce/causalai: Salesforce CausalAI Library: A Fast and Scalable framework for Causal Analysis of Time Series and Tabular Data (github.com)](https://github.com/salesforce/causalai)
    - Causal Analysis of Time Series and Tabular Data
- #CODE [GitHub - py-why/EconML: ALICE (Automated Learning and Intelligence for Causation and Economics) is a Microsoft Research project](https://github.com/py-why/EconML/)
    - [https://www.pywhy.org/](https://www.pywhy.org/)
    - [EconML/notebooks at main · py-why/EconML · GitHub](https://github.com/py-why/EconML/tree/main/notebooks)
    - [Causal inference (Part 2 of 3): Selecting algorithms | by Jane Huang | Data Science at Microsoft | Medium](https://medium.com/data-science-at-microsoft/causal-inference-part-2-of-3-selecting-algorithms-a966f8228a2d) 
- #CODE [BasisResearch/chirho: An experimental language for causal reasoning (github.com)](https://github.com/BasisResearch/chirho)
    - [Causal Reasoning with ChiRho — chirho documentation (basisresearch.github.io)](https://basisresearch.github.io/chirho/getting_started.html)
    - [Causal probabilistic programming without tears — chirho documentation (basisresearch.github.io)](https://basisresearch.github.io/chirho/tutorial_i.html)
- #CODE [https://github.com/pymc-labs/CausalPy](https://github.com/pymc-labs/CausalPy)
    - [CausalPy - causal inference for quasi-experiments — CausalPy 0.0.14 documentation](https://causalpy.readthedocs.io/en/latest/) 
- #CODE [GitHub - daolayal/multi_uplift: Mutitreatment uplift modeling techniques and evaluation approaches](https://github.com/daolayal/multi_uplift)
    - In R. Paper survey by Olaya et al
    - multitreatment modified outcome approach 
- #CODE [GitHub - Ibotta/mr_uplift: Multiple Response Uplift (or heterogeneous treatment effects) package that builds and evaluates tradeoffs with multiple treatments and multiple responses](https://github.com/Ibotta/mr_uplift)
    - [Estimating and Visualizing Business Tradeoffs in Uplift Models | by Sam Weiss | Building Ibotta | Medium](https://medium.com/building-ibotta/estimating-and-visualizing-business-tradeoffs-in-uplift-models-80ff845a5698)
    - Synt data: [mr_uplift/examples/mr_uplift_propensity_score.ipynb at master · Ibotta/mr_uplift · GitHub](https://github.com/Ibotta/mr_uplift/blob/master/examples/mr_uplift_propensity_score.ipynb) 
- #CODE [https://github.com/rsyi/pylift](https://github.com/rsyi/pylift)
    - [https://pylift.readthedocs.io/en/latest/introduction.html](https://pylift.readthedocs.io/en/latest/introduction.html)
    - [About Wayfair | Pylift: A Fast Python Package for Uplift Modeling](https://www.aboutwayfair.com/tech-innovation/pylift-a-fast-python-package-for-uplift-modeling/) 
- #CODE [GitHub - maks-sh/scikit-uplift: :exclamation: uplift modeling in scikit-learn style in python :snake:](https://github.com/maks-sh/scikit-uplift)
    - No multitreatment
    - [Jupyter Notebook - The overview of the basic approaches to solving the Uplift Modeling problem (skuplift)](https://nbviewer.org/github/maks-sh/scikit-uplift/blob/master/notebooks/RetailHero_EN.ipynb#1.2-Class-Transformation)
    - [Multitreatment model // dummy and interactions approach [DIA] · Issue #191 · maks-sh/scikit-uplift · GitHub](https://github.com/maks-sh/scikit-uplift/issues/191)
    - [A Statistical Learning Approach to Personalization in Revenue Management by Xi Chen, Zachary Owen, Clark Pixton, David Simchi-Levi :: SSRN](https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2579462) 
- #CODE [GitHub - uber/causalml: Uplift modeling and causal inference with machine learning algorithms](https://github.com/uber/causalml)
    - [CausalML: Python Package for Causal Machine Learning (arxiv.org)](https://arxiv.org/abs/2002.11631)
    - CausalML - multiple treatment: [causalml/examples/meta_learners_with_synthetic_data_multiple_treatment.ipynb at master · uber/causalml · GitHub](https://github.com/uber/causalml/blob/master/examples/meta_learners_with_synthetic_data_multiple_treatment.ipynb) 
- #CODE [GitHub - Minyus/causallift: CausalLift: Python package for causality-based Uplift Modeling in real-world business](https://github.com/Minyus/causallift)
    - No multitreatment
    - [CausalLift: Python package for Uplift Modeling in real-world business; applicable for both A/B testing and observational data | by Yusuke Minami | Medium](https://medium.com/@Minyus86/causallift-python-package-for-uplift-modeling-in-real-world-business-e60264812a26) 
- #CODE [GitHub - bookingcom/upliftml: UpliftML: A Python Package for Scalable Uplift Modeling](https://github.com/bookingcom/upliftml)
    - [A Cost-Optimization Approach to Uplift Modelling - Folio3AI Blog](https://www.folio3.ai/blog/a-cost-optimization-approach-to-uplift-modelling/)
- #CODE [GitHub - BiomedSciAI/causallib: A Python package for modular causal inference analysis and model evaluations](https://github.com/BiomedSciAI/causallib)
    - IPW - [causallib/examples/ipw.ipynb at master · BiomedSciAI/causallib · GitHub](https://github.com/BiomedSciAI/causallib/blob/master/examples/ipw.ipynb)
    - [causallib/causallib/estimation/ipw.py at master · BiomedSciAI/causallib · GitHub](https://github.com/BiomedSciAI/causallib/blob/master/causallib/estimation/ipw.py)

## References
- #PAPER [Uplift Modeling : Identifying Optimal Treatment Group Allocation and Whom to Contact to Maximize Return on Investment (2019)](https://www.semanticscholar.org/paper/Uplift-Modeling-%3A-Identifying-Optimal-Treatment-and-Karlsson/7be1a37e2a0224259745e7e1217e02e2c2323cda)
- #PAPER [Reinforcement Learning for Uplift Modeling (2019)](https://arxiv.org/abs/1811.10158v2)
- #THESIS/MSC [Segmentación de clientes segun su receptividad a camapñas de marketing de productos (2020)](https://repositorio.uchile.cl/bitstream/handle/2250/178605/Segmentacion-de-clientes-segun-su-receptividad-a-campanas-de-marketing-de-productos.pdf?sequence=3)
- #PAPER [Why you should stop predicting customer churn and start using uplift models (2021)](https://www.sciencedirect.com/science/article/pii/S0020025519312022)
- #PAPER [Feature Selection Methods for Uplift Modeling and Heterogeneous Treatment Effect (2022)](https://arxiv.org/abs/2005.03447)
- #PAPER [Machine Learning Prescriptive Canvas for Optimizing Business Outcomes (2022)](https://arxiv.org/abs/2206.10333)
- #PAPER [Uplift Modeling: from Causal Inference to Personalization (2023)](https://arxiv.org/abs/2308.09066)

### Meta-learners
- #PAPER [Meta-learners for Estimating Heterogeneous Treatment Effects using Machine Learning](https://arxiv.org/abs/1706.03461)
- #PAPER [Comparison of meta-learners for estimating multi-valued treatment heterogeneous effects](https://arxiv.org/abs/2205.14714)
    - [GitHub - nacharki/multipleT-MetaLearners](https://github.com/nacharki/multipleT-MetaLearners)
### Multiple treatments
- #PAPER [Uplift Modeling with Multiple Treatments and General Response Types (arxiv.org)](https://arxiv.org/pdf/1705.08492.pdf)
- #PAPER [A survey and benchmarking study of multitreatment uplift modeling | SpringerLink](https://link.springer.com/article/10.1007/s10618-019-00670-y)